<header class="navbar sticky">
  <div class="navbar-left">
    <div class="site-title">Piotr Kawa Portfolio</div>
  </div>

  <nav class="navbar-right">
    <button class="menu-toggle" id="menu-toggle" aria-expanded="false" aria-controls="menu-items">‚ò∞</button>

    <div class="menu-items" id="menu-items">
      <!-- GitHub -->
      <a href="https://github.com/pkawa95" class="github-link" target="_blank" rel="noopener noreferrer">
        <img data-img="img/icons/github.svg" alt="GitHub" class="github-icon" />
        GitHub
      </a>

      <a data-target="index.html" data-i18n="home">Strona g≈Ç√≥wna</a>
      <a data-target="projekty.html" data-i18n="projects">Projekty</a>
      <a data-target="omnie.html" data-i18n="about">O mnie</a>
      <a data-target="dokumenty.html" data-i18n="docs">Dokumenty</a>
      <a data-target="kontakt.html" data-i18n="contact">Kontakt</a>
      <a data-target="updates.html" class="has-badge">
  <span class="link-label" data-i18n="menu_update">Aktualizacje
    <img data-img="img/icons/badge-new.svg" alt="" aria-hidden="true" class="badge-new">
  </span>
</a>

      <!-- ‚Äî‚Äî‚Äî USTAWIENIA ‚Äî z i18n ‚Äî‚Äî‚Äî -->
      <hr class="settings-divider" aria-hidden="true">

      <div class="menu-settings" role="group">
        <!-- podpis jako element (t≈Çumaczalny) -->
        <div class="settings-caption" data-i18n="settings_caption">Ustawienia</div>

        <!-- Jƒôzyk (chip) -->
        <button id="lang-toggle"
                class="btn-setting"
                type="button"
                aria-pressed="false"
                data-lang="pl"
                data-i18n-attr="aria-label"
                aria-label="Zmie≈Ñ jƒôzyk">
          <span class="icon" aria-hidden="true">üåê</span>
          <span class="label" data-i18n="language_label">Jƒôzyk</span>
          <span class="lang-badge">PL</span>
        </button>

        <!-- Tryb jasny/ciemny (opisany switch) -->
        <div class="setting-switch">
          <span class="icon" aria-hidden="true">üåì</span>
          <span class="label" data-i18n="theme_label">Tryb</span>
          <label class="switch" data-i18n-attr="aria-label" aria-label="Prze≈ÇƒÖcz motyw">
            <input type="checkbox" id="theme-toggle">
            <span class="slider round"></span>
          </label>
          <!-- Uwaga: bez data-i18n, JS ustawi tu 'co siƒô stanie po klikniƒôciu' -->
          <span id="theme-state" class="state">
  <!-- Gdy TERAZ jest jasny -> poka≈º co bƒôdzie po klikniƒôciu: "Ciemny" -->
  <span class="next-if-light" data-i18n="theme_state_dark">Ciemny</span>
  <!-- Gdy TERAZ jest ciemny -> poka≈º co bƒôdzie po klikniƒôciu: "Jasny" -->
  <span class="next-if-dark"  data-i18n="theme_state_light">Jasny</span>
</span>
        </div>
      </div>
    </div>
  </nav>

  <div class="scroll-progress"></div>
</header>

<!-- Nowy pasek changeloga -->
<div class="changelog-bar" id="changelog-placeholder" data-src="/addons/changelog/changelog.html"></div>

<!-- ===== Uzupe≈ÇniajƒÖce style tylko dla sekcji Ustawienia (kompakt + i18n caption) ===== -->
<style>
  /* ============== NAVBAR ‚Äì PANEL USTAWIE≈É (neo blue‚Üîviolet, kompakt) ============== */
/* Aktywny link w menu */
.menu-items a.active {
  position: relative;
  color: #fff;
  background: linear-gradient(135deg, hsl(220 92% 60%), hsl(285 90% 62%));
  border-radius: 8px;
  padding: 6px 10px;
  box-shadow:
    0 2px 6px hsl(220 92% 60% / .35),
    0 4px 10px hsl(285 90% 62% / .35);
  text-shadow: 0 0 6px rgba(0,0,0,.35);
}

.menu-items a.active::after {
  transform: scaleX(1);
  transform-origin: left;
}

.navbar .settings-divider{
  border:0;
  height:1px;
  margin:4px 0 6px;
  background:linear-gradient(90deg, transparent, hsl(var(--accent)/.45), transparent);
  opacity:.7;
}

.navbar .menu-settings{
  display:grid;
  grid-template-columns:1fr auto;
  gap:6px; /* by≈Ço 8px */
  padding:6px 8px;
  border-radius:10px;
  background:hsl(var(--glass));
  -webkit-backdrop-filter:blur(8px) saturate(1.05);
  backdrop-filter:blur(8px) saturate(1.05);
  border:1px solid hsl(var(--border));
  box-shadow:0 4px 10px hsl(var(--shadow-1));
  position:relative;
  isolation:isolate;
}

/* caption ‚ÄûUstawienia‚Äù ‚Äî gradient blue‚Üîviolet */
.navbar .settings-caption{
  position:absolute;
  top:-8px;
  left:10px;
  font-size:.66rem;
  font-weight:700;
  padding:1px 6px;
  border-radius:999px;
  color:#fff;
  background:linear-gradient(135deg, hsl(220 92% 60%), hsl(285 90% 62%));
  box-shadow:0 3px 8px hsl(220 92% 60% / .28);
}

.navbar .btn-setting{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:6px;
  width:100%;
  padding:7px 9px; /* by≈Ço 8px 10px */
  border-radius:10px;
  border:1px solid hsl(var(--border));
  background:hsl(var(--surface));
  box-shadow:0 2px 6px hsl(var(--shadow-1));
  font-weight:700;
  font-size:.84rem; /* by≈Ço .88rem */
  cursor:pointer;
  color:hsl(var(--fg));
  transition:transform .15s, box-shadow .15s, border-color .15s, background .15s;
}
.navbar .btn-setting .icon{ font-size:.9rem; }
.navbar .btn-setting .label{ opacity:.85; font-size:.8rem; }

.navbar .lang-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:26px;
  height:18px;
  padding:0 5px;
  border-radius:999px;
  font-size:.68rem;
  font-weight:800;
  background:linear-gradient(145deg, hsl(var(--accent-300)), hsl(var(--accent)));
  color:#fff;
}

.navbar .btn-setting:hover{
  transform:translateY(-1px);
  box-shadow:0 6px 14px hsl(var(--shadow-2));
  border-color:hsl(var(--accent)/.4);
}
.navbar .btn-setting:focus-visible{
  outline:2px solid hsl(var(--ring));
  outline-offset:2px;
}

/* switch (motyw) ‚Äî kompakt + gradientowy cie≈Ñ pod KROPKƒÑ */
.navbar .setting-switch{
  display:flex;
  align-items:center;
  gap:6px;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid hsl(var(--border));
  background:hsl(var(--surface));
  box-shadow:0 2px 6px hsl(var(--shadow-1));
  font-size:.84rem;
  cursor:pointer;
  transition:transform .18s, box-shadow .18s;
}
.navbar .setting-switch .icon{ font-size:.9rem; }
.navbar .setting-switch .label{ font-weight:700; opacity:.85; font-size:.82rem; }
.navbar .setting-switch .state{
  font-size:.72rem;
  font-weight:700;
  padding:1px 6px;
  border-radius:999px;
  margin-left:3px;
  background:hsl(var(--accent)/.12);
  color:hsl(var(--fg));
}

/* ‚Äî‚Äî‚Äî Glow pod KROPKƒÑ (suwakiem) ‚Äî‚Äî‚Äî */
.navbar .setting-switch .slider::before{
  box-shadow:
    0 0 6px hsl(220 92% 60% / .22),
    0 0 8px hsl(285 90% 62% / .22);
  transition: box-shadow .25s ease;
}
.navbar .setting-switch input:checked + .slider::before{
  box-shadow:
    0 0 10px hsl(220 92% 60% / .45),
    0 0 14px hsl(285 90% 62% / .45);
}

/* subtelny glow na tle suwaka */
.navbar .setting-switch .slider{
  transition: box-shadow .25s ease;
  box-shadow:
    inset 0 2px 6px rgba(0,0,0,.12),
    0 1px 0 rgba(255,255,255,.5);
}
.navbar .setting-switch input:checked + .slider{
  box-shadow:
    inset 0 2px 6px rgba(0,0,0,.18),
    0 1px 0 rgba(255,255,255,.35),
    0 0 10px hsl(220 92% 60% / .22),
    0 0 12px hsl(285 90% 62% / .22);
}

@media (max-width:768px){
  .navbar .menu-settings{ grid-template-columns:1fr; }
  .navbar .setting-switch{ justify-content:space-between; }
}

body.dark .navbar .btn-setting,
body.dark .navbar .setting-switch{
  background:hsl(var(--surface));
  border-color:hsl(var(--border));
  box-shadow:0 6px 14px hsl(var(--shadow-2));
}

/* Pokazuj "co bƒôdzie po klikniƒôciu" bez JS */
#theme-state .next-if-dark { display:none; }
body.dark #theme-state .next-if-light { display:none; }
body.dark #theme-state .next-if-dark  { display:inline; }

/* Badge ‚ÄûNEW‚Äù ‚Äî absolutna ≈õcie≈ºka */
.menu-items a.has-badge{
  position:relative;
  display:inline-flex;
  align-items:center;
}
.menu-items a.has-badge .link-label{
  position:relative;
  display:inline-block;
  line-height:1.1;
}
.menu-items a[data-target="updates.html"]{
  position:relative;
  display:inline-flex;
  align-items:center;
}
.menu-items a[data-target="updates.html"]::before{
  content:"";
  position:absolute;
  top:-0.55em;
  right:-0.8em;
  width:1.3em;
  height:1.3em;
  background:no-repeat center/contain;
  background-image:url("/img/icons/badge-new.svg"); /* absolutna ≈õcie≈ºka */
  z-index:2;
  pointer-events:none;
  user-select:none;
  filter:drop-shadow(0 2px 6px rgba(0,0,0,.18));
}

/* Mobile badge */
@media (max-width:768px){
  .menu-items a[data-target="updates.html"]::before{
    top:-0.5em;
    right:-0.7em;
    width:1.2em;
    height:1.2em;
  }
}

/* Hover link√≥w w menu ‚Äî podkre≈õlenie gradientem */
.menu-items a{
  position:relative;
  display:inline-block;
  padding:6px 4px;
  font-weight:600;
  color:hsl(var(--fg));
  text-decoration:none;
  transition:color .25s ease;
}
.menu-items a::after{
  content:"";
  position:absolute;
  left:0;
  bottom:0;
  width:100%;
  height:2px;
  background:linear-gradient(90deg, hsl(220 92% 60%), hsl(285 90% 62%));
  transform:scaleX(0);
  transform-origin:right;
  transition:transform .3s ease;
  border-radius:2px;
}
.menu-items a:hover{
  color:hsl(var(--accent));
  text-shadow:0 0 6px hsl(220 92% 60% / .35),
              0 0 10px hsl(285 90% 62% / .35);
}
.menu-items a:hover::after{
  transform:scaleX(1);
  transform-origin:left;
}
</style>


<!-- ===== JS: hamburger + i18n (PL/EN) + pamiƒôƒá jƒôzyka/motywu + ODWR√ìCONY label (pokazuj co siƒô stanie po klikniƒôciu) ===== -->
<script>
(function(){
  // ===== CONFIG (PL/EN) =====
  const dict = {
    pl: { nextLight: "Jasny", nextDark: "Ciemny" },
    en: { nextLight: "Light", nextDark: "Dark" }
  };

  // czekamy na DOM (gdyby skrypt by≈Ç w <head>)
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init, { once:true });
  } else {
    init();
  }

  function init(){
    const langBtn     = document.getElementById('lang-toggle');
    const themeChk    = document.getElementById('theme-toggle');
    const themeState  = document.getElementById('theme-state');
    const settingRow  = document.querySelector('.setting-switch');

    // je≈õli czegokolwiek brakuje, pr√≥bujemy p√≥≈∫niej
    if (!themeState || !themeChk) {
      setTimeout(init, 100);
      return;
    }

    // 1) zbij i18n na tym elemencie, aby nic go nie nadpisywa≈Ço
    themeState.removeAttribute('data-i18n');
    themeState.removeAttribute('data-i18n-attr');

    // 2) helpery
    const getLang = () => (localStorage.getItem('lang') || langBtn?.getAttribute('data-lang') || 'pl').toLowerCase();
    const getDict = () => dict[getLang()] || dict.pl;

    // Ustaw label = NASTƒòPNY stan (co siƒô stanie po klikniƒôciu), oraz checkbox
    function syncFromBody(){
      const isDark = document.body.classList.contains('dark');
      // pokazywany tekst = tryb, na kt√≥ry PRZE≈ÅƒÑCZY klik
      themeState.textContent = isDark ? getDict().nextLight : getDict().nextDark;
      if (themeChk) themeChk.checked = isDark;
    }

    // Ustaw tryb i zapisz
    function setTheme(nextMode){
      const wantDark = nextMode === 'dark';
      document.body.classList.toggle('dark', wantDark);
      try { localStorage.setItem('theme', nextMode); } catch(e){}
      syncFromBody();
    }

    // 3) INIT ‚Äî preferencje: localStorage ‚Üí klasa na body ‚Üí prefers-color-scheme
    let initial = localStorage.getItem('theme');
    if (!initial) {
      initial = document.body.classList.contains('dark')
        ? 'dark'
        : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    }
    document.body.classList.toggle('dark', initial === 'dark');
    syncFromBody();

    // 4) LISTENERY
    // checkbox
    themeChk.addEventListener('change', () => {
      setTheme(themeChk.checked ? 'dark' : 'light');
    });

    // klik w CA≈ÅY wiersz (poza samym input/slider)
    settingRow?.addEventListener('click', (e) => {
      if (e.target.closest('input, .slider')) return;
      const nextIsDark = !document.body.classList.contains('dark');
      setTheme(nextIsDark ? 'dark' : 'light');
    });

    // je≈õli inny skrypt zmieni klasƒô na <body> ‚Üí zsynchronizuj
    new MutationObserver(syncFromBody).observe(document.body, { attributes:true, attributeFilter:['class'] });

    // je≈õli i18n/inna biblioteka spr√≥buje nadpisaƒá tekst ‚Äî cofamy na nasze
    new MutationObserver(() => syncFromBody()).observe(themeState, { childList:true, characterData:true, subtree:true });

    // zmiana jƒôzyka (Tw√≥j przycisk / system) ‚Üí przelicz napisy
    langBtn?.addEventListener('click', () => setTimeout(syncFromBody, 0));
    window.addEventListener('languagechange', () => setTimeout(syncFromBody, 0));

    // 5) ‚Äûbezpiecznik‚Äù: przez pierwsze 2 sekundy resync co 300ms (po inicjalizacjach innych skrypt√≥w),
    // potem co 5s lekki watchdog (nic nie kosztuje)
    let t = 0;
    const fast = setInterval(() => {
      syncFromBody();
      t += 300;
      if (t >= 2000) clearInterval(fast);
    }, 300);
    setInterval(syncFromBody, 5000);
  }
})();

// ===== Aktywny link w menu =====
(function(){
  const current = window.location.pathname.split("/").pop() || "index.html";
  const links = document.querySelectorAll(".menu-items a[data-target]");
  
  links.forEach(link => {
    if (link.getAttribute("data-target") === current) {
      link.classList.add("active");
    }
  });
})();


</script>


